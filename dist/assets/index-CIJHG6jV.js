import{j as e,L as N,e as s,b as g,r as y,h as A}from"./index-DCB2o80S.js";import{c as P,b as v,m as O,u as S,o as k,e as F,l as E}from"./Route-BzkLDGJv.js";import"./iconBase-BneYDday.js";import"./index-CzEfZKJO.js";const T=P().shape({name:v().required("Name is required"),email:v().email("Email should be in correct format").required("Email is required"),terms:O().oneOf([!0],"You must accept the terms and conditions")}),$=({setEmail:m,setOtpTimerActive:f,setShowOtpScreen:u})=>{var w,b,p;const c=S({defaultValues:{name:"",email:"",terms:!1},resolver:k(T)}),{register:i,handleSubmit:o,formState:h}=c,{errors:a}=h,j=async l=>{console.log("===================================="),console.log(l),console.log("====================================");const{email:x,name:t}=l,n=s.loading(`Sending OTP to ${x}`);m(x);try{const r=await g.post("http://localhost:5000/api/v1/auth/send-otp",{email:x,name:t});r&&r.data?(u(d=>!d),f(d=>!d),s.dismiss(n),s.success("OTP sent succesfully"),console.log(r)):(r&&r.status===400?(s.dismiss(n),s.error("Invalid email"),s("Internal server error"),console.log(r)):(s.dismiss(n),console.error("Some error occured")),s.dismiss(n),console.error("Some error occured"))}catch(r){if(g.isAxiosError(r))if(r.response&&r.response.data){const d=r.response.data.message;s.dismiss(n),s.error(d)}else s.dismiss(n),s.error("An error occurred");else s.dismiss(n),console.error("An error occurred:",r)}};return e.jsx("div",{children:e.jsxs("form",{noValidate:!0,className:"space-y-4 md:space-y-6",onSubmit:o(j),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-white",children:"Your Name"}),e.jsx("input",{...i("name"),type:"text",id:"name",className:" border   sm:text-sm rounded-lg  block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your name"}),e.jsx("div",{className:"mt-1",children:a.email?e.jsxs("p",{className:"text-red-500 text-xs italic",children:[(w=a.email)==null?void 0:w.message," "]}):e.jsx("div",{style:{height:"1rem"}})}),e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-white",children:"Your email"}),e.jsx("input",{...i("email"),type:"email",id:"email",className:" border   sm:text-sm rounded-lg  block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500",placeholder:"abc@abc.com"}),e.jsx("div",{className:"mt-1",children:a.email?e.jsxs("p",{className:"text-red-500 text-xs italic",children:[(b=a.email)==null?void 0:b.message," "]}):e.jsx("div",{style:{height:"1rem"}})})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{id:"terms","aria-describedby":"terms",type:"checkbox",className:"w-4 h-4 border  rounded focus:ring-3  bg-gray-700 border-gray-600 focus:ring-primary-600 ring-offset-gray-800",...i("terms")})}),e.jsxs("div",{className:"ml-3 text-sm",children:[e.jsxs("label",{htmlFor:"terms",className:"font-light text-gray-300",children:["I accept the"," ",e.jsx(N,{className:"font-medium  hover:underline text-primary-500",to:"/termsConditions",children:"Terms and Conditions"})]}),e.jsx("div",{children:a.terms?e.jsxs("p",{className:"text-red-500 text-xs italic",children:[(p=a.terms)==null?void 0:p.message," "]}):e.jsx("div",{style:{height:"1rem"}})})]})]}),e.jsx("button",{type:"submit",className:"w-full text-white bg-blue-500  focus:ring-4 focus:outline-none  font-medium rounded-lg text-sm px-5 py-2.5 text-center bg-primary-600 hover:bg-green-500 focus:ring-primary-800",children:"Verify your email"}),e.jsxs("p",{className:"text-sm font-light text-gray-400",children:["Already have an account?"," ",e.jsx(N,{to:"/login",className:"font-medium   hover:underline text-blue-500",children:"Login here"})]})]})})},q=P().shape({otp:v().matches(/^\d{6}$/,"Otp should be of 6 digits").required("OTP is required")}),I=({email:m,setShowPasswordScreen:f,setShowOtpScreen:u})=>{const[c,i]=y.useState(1),[o,h]=y.useState(59);y.useEffect(()=>{const t=setInterval(()=>{o>0&&h(o-1),o===0&&(c===0?clearInterval(t):(h(59),i(c-1)))},1e3);return()=>{clearInterval(t)}},[o]);const a=S({defaultValues:{otp:""},resolver:k(q)}),{register:j,handleSubmit:w,formState:b}=a,{errors:p}=b,l=async t=>{const{otp:n}=t;try{const r=await g.post("http://localhost:5000/api/v1/auth/verify-otp",{email:m,otp:n});r&&r.data?(u(d=>!d),f(d=>!d),s.success("OTP verified succesfully"),console.log(r)):console.error("Some error occured")}catch(r){if(g.isAxiosError(r))if(r.response&&r.response.data){const d=r.response.data.message;s.error(d)}else s.error("An error occurred");else s.error("An error occurred"),console.error("An error occurred:",r);console.log(r)}},x=async()=>{try{const t=await g.post("http://localhost:5000/api/v1/auth/resend-otp",{email:m});t&&t.data?(h(59),i(1),s.success("OTP resent succesfully"),console.log(t)):console.error("Some error occured")}catch(t){if(g.isAxiosError(t))if(t.response&&t.response.data){const n=t.response.data.message;s.error(n)}else s.error("An error occurred");else s.error("An error occurred"),console.error("An error occurred:",t);console.log(t)}};return e.jsx("div",{children:e.jsxs("form",{noValidate:!0,className:"space-y-4 md:space-y-6",onSubmit:w(l),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otp",className:"block mb-2 text-sm font-medium text-white",children:"Your OTP"}),e.jsx("input",{type:"text",...j("otp"),id:"otp",className:" border   sm:text-sm rounded-lg  block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter OTP",required:!0}),e.jsx("div",{children:p.otp?e.jsx("p",{className:"text-red-500 text-xs italic",children:p.otp.message}):e.jsx("div",{style:{height:"1rem"}})})]}),e.jsx("button",{type:"submit",className:"w-full text-white bg-blue-500  focus:ring-4 focus:outline-none  font-medium rounded-lg text-sm px-5 py-2.5 text-center bg-primary-600 hover:bg-green-500 focus:ring-primary-800",children:"Verify OTP"}),e.jsxs("p",{className:"text-sm font-light text-gray-400",children:["Time remaining:",e.jsxs("div",{children:[c<10?`0${c}`:c,":",o<10?`0${o}`:o]})," ",e.jsx("button",{type:"button",disabled:o>0||c>0,onClick:()=>{x()},className:`font-medium    hover:underline text-primary-500 ${o>0||c>0?"cursor-not-allowed opacity-50":"cursor-pointer"} `,children:"Resend OTP"})]})]})})},V=P().shape({password:v().required("Password is required").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[0-9]/,"Password must contain at least one number").matches(/[!@#$%^&*(),.?":{}|<>]/,"Password must contain at least one special character").min(8,"Password must be at least 8 characters long"),verifyPassword:v().oneOf([F("password"),""],"Passwords must match").required("Password confirmation is required")}),C=({email:m,setShowPasswordScreen:f})=>{const u=A(),c=S({defaultValues:{password:"",verifyPassword:""},resolver:k(V)}),{register:i,handleSubmit:o,formState:h}=c,{errors:a}=h,j=async w=>{const{password:b,verifyPassword:p}=w;if(b!==p){s("Passwords do not match",{icon:"ðŸ”’"}),console.log("===================================="),console.log("passwords do not match"),console.log("====================================");return}try{const l=await g.post("http://localhost:5000/api/v1/auth/set-password",{email:m,password:b,verifyPassword:p});l&&l.data?(f(x=>!x),s.success("Password set successfully"),s.success("Login to continue"),u("/login"),console.log(l)):(s.error("Internal server error"),console.error("Some error occured"))}catch(l){if(g.isAxiosError(l))if(l.response&&l.response.data){const x=l.response.data.message;s.error(x)}else s.error("An error occurred");else s.error("An error occurred"),console.error("An error occurred:",l);console.log(l)}};return e.jsx("div",{children:e.jsxs("form",{noValidate:!0,className:"space-y-4 md:space-y-6",onSubmit:o(j),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-white",children:"Password"}),e.jsx("input",{type:"password",...i("password"),id:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",className:" border   sm:text-sm rounded-lg  block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500"}),e.jsx("div",{children:a.password?e.jsx("p",{className:"text-red-500 text-xs italic",children:a.password.message}):e.jsx("div",{style:{height:"1rem"}})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block mb-2 text-sm font-medium text-white",children:"Confirm password"}),e.jsx("input",{type:"password",...i("verifyPassword"),id:"confirmPassword",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",className:" border  sm:text-sm rounded-lg  block w-full p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500",required:!0}),e.jsx("div",{children:a.verifyPassword?e.jsx("p",{className:"text-red-500 text-xs italic",children:a.verifyPassword.message}):e.jsx("div",{style:{height:"1rem"}})})]}),e.jsx("button",{type:"submit",className:"w-full text-white bg-blue-500  focus:ring-4 focus:outline-none  font-medium rounded-lg text-sm px-5 py-2.5 text-center bg-primary-600 hover:bg-green-500 focus:ring-primary-800",children:"Create an account"}),e.jsxs("p",{className:"text-sm font-light text-gray-400",children:["Already have an account?"," ",e.jsx(N,{to:"/login",className:"font-medium  hover:underline text-primary-500",children:"Login here"})]})]})})},L=()=>{const[m,f]=y.useState(""),[u,c]=y.useState(!1),[i,o]=y.useState(!1),[h,a]=y.useState(!1);return console.log(h),e.jsx(e.Fragment,{children:e.jsx("section",{style:{backgroundImage:`url(${E})`},className:"bg-no-repeat bg-center bg-cover ",children:e.jsx("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto h-screen lg:py-0 ",children:e.jsxs("div",{className:"w-full   shadow   md:mt-0 sm:max-w-md xl:p-0 bg-transparent",children:[u===!1&&i===!1&&e.jsxs("div",{className:"p-6 space-y-4 rounded-3xl md:space-y-6 sm:p-8 backdrop-blur-md bg-black/50 ",children:[e.jsx("h1",{className:"text-xl font-bold leading-tight tracking-tight  md:text-2xl text-white",children:"Create an account"}),e.jsx("div",{children:e.jsx($,{setEmail:f,setOtpTimerActive:a,setShowOtpScreen:c})})]}),u===!0&&i===!1&&e.jsxs("div",{className:"p-6 space-y-4 md:space-y-6 sm:p-8 backdrop-blur-md bg-black/50 rounded-3xl",children:[e.jsx("h1",{className:"text-xl font-bold leading-tight tracking-tight  md:text-2xl text-white",children:"Enter OTP"}),e.jsx(I,{email:m,setShowOtpScreen:c,setShowPasswordScreen:o})]}),u===!1&&i===!0&&e.jsxs("div",{className:"p-6 space-y-4 md:space-y-6 sm:p-8 backdrop-blur-md bg-black/50 rounded-3xl",children:[e.jsx("h1",{className:"text-xl font-bold leading-tight tracking-tight  md:text-2xl text-white",children:"Enter password"}),e.jsx("div",{children:e.jsx(C,{email:m,setShowPasswordScreen:o})})]})]})})})})},Z=()=>e.jsx(e.Fragment,{children:e.jsx(L,{})});export{Z as default};
