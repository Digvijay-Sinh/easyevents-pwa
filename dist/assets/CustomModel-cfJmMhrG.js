import{h as j,u as y,r as b,j as e,L as w,f as v,e as h}from"./index-DCB2o80S.js";import{B as c}from"./iconBase-BneYDday.js";import{a as N}from"./index-CzEfZKJO.js";let d;const k=new Uint8Array(16);function S(){if(!d&&(d=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!d))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d(k)}const n=[];for(let t=0;t<256;++t)n.push((t+256).toString(16).slice(1));function U(t,s=0){return n[t[s+0]]+n[t[s+1]]+n[t[s+2]]+n[t[s+3]]+"-"+n[t[s+4]]+n[t[s+5]]+"-"+n[t[s+6]]+n[t[s+7]]+"-"+n[t[s+8]]+n[t[s+9]]+"-"+n[t[s+10]]+n[t[s+11]]+n[t[s+12]]+n[t[s+13]]+n[t[s+14]]+n[t[s+15]]}const D=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),g={randomUUID:D};function T(t,s,a){if(g.randomUUID&&!s&&!t)return g.randomUUID();t=t||{};const l=t.random||(t.rng||S)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,s){a=a||0;for(let i=0;i<16;++i)s[a+i]=l[i];return s}return U(l)}const E=({setBooked:t,handleCloseModal:s,eventId:a,eventPrice:l})=>{const i=j(),{auth:m}=y(),[r,u]=b.useState(1),f=async x=>{x.preventDefault();try{const o=T().replace(/-/g,"").slice(0,16),p=await v.post("https://easyeventsbackend-pwa.onrender.com/api/v1/booking",{eventId:a,numberOfTickets:r,totalAmount:r*l,bookingStatus:"Confirm",paymentStatus:"Confirm",paymentMethod:"online",bookingDateTime:new Date().toISOString(),bookingReference:o});t(!0),h.success("Booking Successfull"),i(`/event/${a}`),s(),console.log("response",p.data.data.id),console.log("Response:",p.data)}catch(o){h.error(o.response.data.message),console.error("Error:",o.response.data.message)}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"fixed bg-black rounded-lg top-[50%] left-1/2 transform -translate-x-1/2 -translate-y-[58%]  md:w-[60vw] w-[90vw] flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface-200 h-full rounded-lg shadow-inner  shadow-slate-300 w-full ",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Book Event"}),e.jsx("button",{type:"button",className:"text-gray-200 bg-transparent hover:bg-purple-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 flex items-center justify-center",onClick:s,children:e.jsx(N,{})})]}),e.jsx("div",{className:"p-4 md:p-5 text-white",children:e.jsx("div",{className:"flex w-full flex-col items-center gap-3 justify-center",children:m!=null&&m.accessToken?e.jsxs("form",{className:"w-full flex flex-col items-center justify-center",onSubmit:f,children:[e.jsxs("div",{className:"datetime flex flex-col gap-3 md:gap-0 md:flex-row justify-start mt-3 sm:w-3/4 w-3/4 ticket sm:py-3  align-middle  ",children:[e.jsxs("div",{className:"md:w-1/2 w-full flex flex-col items-center",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-left text-white",children:"No. Of Tickets"}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(c,{onClick:()=>{r>1&&u(r-1)},className:"rounded-full h-7 w-7",children:"-"}),e.jsx("input",{value:r,onChange:x=>u(parseInt(x.target.value)),type:"number",disabled:!0,className:"border sm:text-sm rounded-lg block w-14 h-9 p-2 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500 text-center"}),e.jsx(c,{onClick:()=>{u(r+1)},className:"rounded-full h-7 w-7",children:"+"})]})]}),e.jsxs("div",{className:"md:w-1/2 w-full flex flex-col items-center",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-left text-white",children:"Ticket Summary"}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsxs("p",{className:"text-white text-sm ",children:[r," X ₹ ",l]}),e.jsx("p",{children:e.jsxs("span",{className:"text-white text-sm font-semibold",children:["= ₹",r*l]})})]})]})]}),e.jsx("div",{children:e.jsx(c,{className:"mt-4",type:"submit",children:"Make Payment"})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[" ",e.jsx("span",{children:"You need to login first "}),e.jsxs(w,{to:"/login",state:{from:`event/${a}`},children:[e.jsx(c,{children:"Login"})," "]})]})})})]})})})};export{E as default};
